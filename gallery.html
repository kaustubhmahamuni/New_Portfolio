<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gallery - MyPortfolio</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
  /* Masonry layout */
  .masonry {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    grid-auto-rows: 10px; /* base row height */
    gap: 8px;
  }
  .masonry-item {
    width: 100%;
    border-radius: 8px;
    cursor: pointer;
    object-fit: cover;
    display: block;
  }
</style>
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-gray-100">

<!-- Navbar -->
<nav class="w-full bg-white dark:bg-gray-800 shadow-md p-4 sticky top-0 z-50">
  <div class="max-w-6xl mx-auto flex justify-between items-center">
    <a href="about.html" class="text-blue-600 dark:text-blue-400 font-semibold hover:underline">
      ‚Üê Back to About
    </a>
  </div>
</nav>

<!-- Gallery Section -->
<section class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
  
  <h1 id="gallery-title" class="text-xl font-bold text-gray-800 dark:text-gray-100 my-9">Gallery</h1>
  <div id="gallery-content" class="masonry"></div>
</section>

<!-- Lightbox Modal -->
<div id="lightbox" class="hidden fixed inset-0 bg-black/80 z-50 flex items-center justify-center">
  <span id="lightbox-close" class="absolute top-4 right-6 text-white text-3xl cursor-pointer">&times;</span>
  <img id="lightbox-img" src="" alt="" class="max-h-[90%] max-w-[90%] rounded-lg shadow-lg">
</div>

<script>
const selectedCollege = localStorage.getItem('selectedCollege') || "Dr. D. Y. Patil Vidyapeeth, Pune";
document.getElementById('gallery-title').innerText = selectedCollege + " Gallery";

const galleryContainer = document.getElementById('gallery-content');

fetch('gallery.json')
  .then(res => {
    if (!res.ok) throw new Error("Gallery JSON not found");
    return res.json();
  })
  .then(data => {
    const gallery = data[selectedCollege];
    if (gallery && gallery.length > 0) {
      gallery.forEach(imgSrc => {
        const img = document.createElement('img');
        img.src = imgSrc;
        img.alt = selectedCollege;
        img.className = "masonry-item";
        img.onload = () => {
          // Adjust grid row span based on image height
          const rowHeight = parseInt(getComputedStyle(galleryContainer).getPropertyValue('grid-auto-rows'));
          const rowGap = parseInt(getComputedStyle(galleryContainer).getPropertyValue('gap'));
          const rowSpan = Math.ceil((img.height + rowGap) / (rowHeight + rowGap));
          img.style.gridRowEnd = `span ${rowSpan}`;
        };
        img.onclick = () => openLightbox(imgSrc);
        galleryContainer.appendChild(img);
      });
    } else {
      galleryContainer.innerHTML = `<p class="text-gray-700 dark:text-gray-200 col-span-3 text-center">No gallery available.</p>`;
    }
  })
  .catch(err => {
    console.error('Failed to load gallery JSON:', err);
    galleryContainer.innerHTML = `<p class="text-red-500 dark:text-red-400 col-span-3 text-center">Failed to load gallery.</p>`;
  });

// Lightbox functions
const lightbox = document.getElementById('lightbox');
const lightboxImg = document.getElementById('lightbox-img');
const lightboxClose = document.getElementById('lightbox-close');

function openLightbox(src) {
    lightbox.classList.remove('hidden');
    lightboxImg.src = src;
}

function closeLightbox() {
    lightbox.classList.add('hidden');
    lightboxImg.src = '';
}

// Close lightbox on click outside image
lightbox.addEventListener('click', (e) => {
    if (e.target === lightbox || e.target === lightboxClose) {
        closeLightbox();
    }
});
</script>
</body>
</html>
